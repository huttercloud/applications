#
# setup {{ .Values.storage_class_name }} volume claims for all services
#

# store completed downloades
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: {{ .Release.Name }}-downloads-complete
  labels:
    app.kubernetes.io/name: {{ .Release.Name }}
spec:
  storageClassName: {{ .Values.storage_class_name }}
  accessModes: [ReadWriteMany]
  resources: { requests: { storage: 800Gi } }

# store downloads which are in progress
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: {{ .Release.Name }}-downloads-incomplete
  labels:
    app.kubernetes.io/name: {{ .Release.Name }}
spec:
  storageClassName: {{ .Values.storage_class_name }}
  accessModes: [ReadWriteMany]
  resources: { requests: { storage: 800Gi } }

# volumes for the different service logs and configuration files
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: {{ .Release.Name }}-bazarr
  labels:
    app.kubernetes.io/name: {{ .Release.Name }}
spec:
  storageClassName: {{ .Values.storage_class_name }}
  accessModes: [ReadWriteOnce]
  resources: { requests: { storage: 1Gi } }
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: {{ .Release.Name }}-sonarr
  labels:
    app.kubernetes.io/name: {{ .Release.Name }}
spec:
  storageClassName: {{ .Values.storage_class_name }}
  accessModes: [ReadWriteOnce]
  resources: { requests: { storage: 1Gi } }
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: {{ .Release.Name }}-radarr
  labels:
    app.kubernetes.io/name: {{ .Release.Name }}
spec:
  storageClassName: {{ .Values.storage_class_name }}
  accessModes: [ReadWriteOnce]
  resources: { requests: { storage: 1Gi } }
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: {{ .Release.Name }}-nzbhydra
  labels:
    app.kubernetes.io/name: {{ .Release.Name }}
spec:
  storageClassName: {{ .Values.storage_class_name }}
  accessModes: [ReadWriteOnce]
  resources: { requests: { storage: 1Gi } }

# nfs volumes to access shared media library
---
apiVersion: v1
kind: PersistentVolume
metadata:
  name: {{ .Release.Name }}-library-movies
  labels:
    app.kubernetes.io/name: {{ .Release.Name }}
spec:
  storageClassName: library-movies
  accessModes: [ReadWriteMany]
  capacity: { storage: 1Gi }
  persistentVolumeReclaimPolicy: Retain 
  nfs: 
    path: {{ .Values.library.base_path }}/movies
    server: {{ .Values.library.nfs_server }}
    readOnly: false
---
apiVersion: v1
kind: PersistentVolume
metadata:
  name: {{ .Release.Name }}-library-tv
  labels:
    app.kubernetes.io/name: {{ .Release.Name }}
spec:
  storageClassName: library-tv
  accessModes: [ReadWriteMany]
  capacity: { storage: 1Gi }
  persistentVolumeReclaimPolicy: Retain 
  nfs: 
    path: {{ .Values.library.base_path }}/tv
    server: {{ .Values.library.nfs_server }}
    readOnly: false
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: {{ .Release.Name }}-library-movies
  labels:
    app.kubernetes.io/name: {{ .Release.Name }}
spec:
  storageClassName: library-movies
  accessModes: [ReadWriteMany]
  resources: { requests: { storage: 1Gi } }
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: {{ .Release.Name }}-library-tv
  labels:
    app.kubernetes.io/name: {{ .Release.Name }}
spec:
  storageClassName: library-tv
  accessModes: [ReadWriteMany]
  resources: { requests: { storage: 1Gi } }